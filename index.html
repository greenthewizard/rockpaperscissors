<!DOCTYPE html>
<html>
<head>
	<title>Rock, Paper, Scissors</title>
</head>
<body>
	<div id="rps">
		<h1>Rock, Paper, Scissors</h1>
		<div id="game-console">
		</div>
	</div>
	<script type="text/javascript">
		$rps = document.getElementById("rps");

		function randInt(min, max) {
			return Math.floor(Math.random() * (max - min + 1)) + min;
		}

		function capitalizeFirstLetter(string) {
			return string.charAt(0).toUpperCase() + string.slice(1);
		}

		function computerPlay() {
			let choices = ["rock", "paper", "scissors"];
			return choices[randInt(0, choices.length - 1)];
		}

		function rps(playerSelection, computerSelection) {
			let choices = ["rock", "paper", "scissors"];
			//If player hits cancel, avoid null for playerSelection.
			playerSelection = playerSelection ? playerSelection : "empty";

			let gameObj = {
				playerSelection: playerSelection.toLowerCase(),
				computerSelection: computerSelection.toLowerCase(),
				resultMsg: "...",
				scorePlayer: 0,
				scoreComputer: 0
			};

			if (choices.indexOf(playerSelection) === -1) {
				gameObj.resultMsg = "You lose! Cheaters always lose..";
				gameObj.scoreComputer++;
			} else if (choices.indexOf(computerSelection) === -1) {
				gameObj.resultMsg = "You win! The computer cheated... somehow.";
				gameObj.scorePlayer++;
			} else if (playerSelection === computerSelection) {
				gameObj.resultMsg = "Tie! " + capitalizeFirstLetter(playerSelection) + " vs " + capitalizeFirstLetter(computerSelection) + "!"
			} else if (playerSelection === "rock") {
				if (computerSelection === "scissors") {
					gameObj.resultMsg = "You Win! Rock beats Paper!";
					gameObj.scorePlayer++;
				} else {
					gameObj.resultMsg = "You Lose! Paper beats Rock!";
					gameObj.scoreComputer++;
				}
			} else if (playerSelection === "paper") {
				if (computerSelection === "rock") {
					gameObj.resultMsg = "You Win! Paper beats Rock!";
					gameObj.scorePlayer++;
				} else {
					gameObj.resultMsg = "You Lose! Scissors beats Paper!";
					gameObj.scoreComputer++;
				}
			} else if (playerSelection === "scissors") {
				if (computerSelection === "paper") {
					gameObj.resultMsg = "You Win! Scissors beats Paper!";
					gameObj.scorePlayer++;
				} else {
					gameObj.resultMsg = "You Lose! Rock beats Scissors!";
					gameObj.scoreComputer++;
				}
			}

			return gameObj;
		}

		function logToGameConsole(msg) {
			let $elem = document.createElement("p");
			let content = document.createTextNode(msg);

			$elem.appendChild(content);
			$rps.appendChild($elem);
		}

		function game(numGames) {
			let score = [0, 0];
			for(let i = 0; i < numGames; i++) {
				let playerSelection = prompt("Rock, Paper, or Scissors?");
				let computerSelection = computerPlay();
				let lastGame = rps(playerSelection, computerSelection);

				score[0] += lastGame.scorePlayer;
				score[1] += lastGame.scoreComputer;
				logToGameConsole(lastGame.resultMsg);
				console.log(lastGame.resultMsg);
			}

			logToGameConsole("Game over!");
			logToGameConsole("Final score is ... Player: " + score[0] + " Computer: " + score[1]);
			if (score[0] > score[1]) {
				logToGameConsole("You win!");
			} else if (score[0] === score[1]) {
				logToGameConsole("Tie game!");
			} else {
				logToGameConsole("You lose!");
			}
		}

		game(4);
	</script>
</body>
</html>